name: BaekjoonHub to Blog
on:
  push:
    paths:
      - '**/README.md'
      - '**/*.cpp'
      - '**/*.java'
      - '**/*.py'

jobs:
  update-blog:
    runs-on: ubuntu-latest

    steps:
      # 1. BaekjoonHub Repository Checkout
      - name: Checkout BaekjoonHub Repository
        uses: actions/checkout@v2
        with:
          repository: 'sms1875/CodingTestStudy'
          path: 'BaekjoonHub'

      # 2. Parse New Problem Files and Generate Blog Post
      - name: Create Blog Post Format
        run: |
          echo "Generating blog posts from newly added problems..."
          # BaekjoonHub 레포에서 문제 파일을 파싱하여 새로운 마크다운 파일 생성 로직 작성

      # 3. Checkout Chirpy Blog Repository
      - name: Checkout Chirpy Blog Repository
        uses: actions/checkout@v2
        with:
          repository: 'sms1875/sms1875.github.io'
          path: 'ChirpyBlog'
          token: ${{ secrets.ACCESS_TOKEN }}  # 권한 설정 (GitHub Secrets 활용)

      # 4. Copy Generated Files to Chirpy Blog Repository
      - name: Move Generated Files to Blog
        run: |
          echo "Copying generated blog posts to Chirpy blog repository..."
          cp -R ./BaekjoonHub/_posts/* ./ChirpyBlog/_posts/

      # 5. Commit and Push to Chirpy Blog Repository
      - name: Commit and Push to sms1875.github.io
        working-directory: sms1875.github.io
        run: |
          git config user.name "sms1875[bot]"
          git config user.email "sms1875@gmail.com"
          git add .
          git commit -m "Add new problem posts from BaekjoonHub"
          git push origin main
